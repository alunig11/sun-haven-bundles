<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sun Haven Bundles</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    html { scroll-behavior: smooth; }
    .bundle-card.completed { display: none; }
    .progress-circle {
      width: 40px; height: 40px; border-radius: 50%;
      background: conic-gradient(#198754 0%, #ddd 0%);
      position: relative; display: inline-block;
      margin-right: 10px; flex-shrink: 0;
    }
    .progress-circle::before {
      content: ""; position: absolute;
      top: 4px; left: 4px; width: 32px; height: 32px;
      background-color: #fff; border-radius: 50%; z-index: 1;
    }
    .progress-circle-inner {
      position: absolute; top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      font-size: 0.75rem; color: #000; z-index: 2;
      white-space: nowrap;
    }
    .checked-label {
      color: #6c757d !important;
      text-decoration: line-through;
    }
    #backToTop {
      position: fixed; bottom: 20px; right: 20px;
      display: none; z-index: 1000;
    }
  </style>
</head>
<body class="bg-light p-3">
  <div class="container">
    <h1 class="mb-3">Sun Haven Bundles</h1>
    <div class="d-flex flex-wrap gap-2 align-items-center mb-3">
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" id="hideCompleted" />
        <label class="form-check-label" for="hideCompleted">Hide Completed Bundles</label>
      </div>
      <button id="exportBtn" class="btn btn-outline-secondary btn-sm">Export Progress</button>
      <label class="btn btn-outline-secondary btn-sm mb-0">
        Import Progress
        <input type="file" id="importFile" accept=".json" hidden />
      </label>
    </div>
    <div class="mb-3">
      <input type="text" class="form-control" id="searchInput" placeholder="Search for an item...">
      <div id="searchResults" class="mt-2"></div>
    </div>
    <div id="tracker"></div>
  </div>
  <button id="backToTop" class="btn btn-secondary btn-sm">â†‘ Top</button>

  <script>
     const data = [
  {
  hall: "Hall of Gems",
  bundles: [
    {
      name: "Money Bundle",
      items: [
        { name: "Coins", amount: 25000 },
        { name: "Mana Orbs", amount: 1000 },
        { name: "Tickets", amount: 1000 }
      ]
    },
    {
      name: "Golden Bundle",
      items: [
        { name: "Golden Milk" },
        { name: "Golden Egg" },
        { name: "Golden Wool" },
        { name: "Golden Pomegranate" },
        { name: "Golden Log" },
        { name: "Golden Feather" },
        { name: "Golden Silk" },
        { name: "Golden Apple" },
        { name: "Golden Orange" },
        { name: "Golden Strawberry" },
        { name: "Golden Blueberry" },
        { name: "Golden Peach" },
        { name: "Golden Raspberry" }
      ]
    },
    {
      name: "Bars Bundle",
      items: [
        { name: "Copper Bar" },
        { name: "Iron Bar" },
        { name: "Gold Bar" },
        { name: "Adamant Bar" },
        { name: "Mithril Bar" },
        { name: "Sunite Bar" },
        { name: "Elven Steel Bar" },
        { name: "Glorite Bar" }
      ]
    },
    {
      name: "Gems Bundle",
      items: [
        { name: "Sapphire" },
        { name: "Ruby" },
        { name: "Amethyst" },
        { name: "Diamond" },
        { name: "Havenite" },
        { name: "Dizzite" },
        { name: "Black Diamond" }
      ]
    },
    {
      name: "Nel'Vari Mines Bundle",
      items: [
        { name: "Mana Shard", amount: 5 },
        { name: "Sparkling Dragon Scale", amount: 5 },
        { name: "Sharp Dragon Scale", amount: 5 },
        { name: "Tough Dragon Scale", amount: 5 }
      ]
    },
    {
      name: "Withergate Mines Bundle",
      items: [
        { name: "Candy Corn Pieces", amount: 5 },
        { name: "Rock Candy Gem", amount: 5 },
        { name: "Jawbreaker Gem", amount: 5 },
        { name: "Hard Butterscotch Gem", amount: 5 }
      ]
    }
  ]
},
  {
  hall: "Hall of Culture",
  bundles: [
    {
      name: "Spring Crops Bundle",
      items: [
        "Grapes", "Wheat", "Tomato", "Corn", "Onion", "Potato",
        "Greenroot", "Carrot", "Kale", "Lettuce", "Cinnaberry",
        "Pepper", "Shimmeroot"
      ].map(i => ({ name: i }))
    },
    {
      name: "Summer Crops Bundle",
      items: [
        "Armoranth", "Guava Berry", "Beet", "Lemon", "Chocoberry",
        "Pineapple", "Pepper", "Melon", "Stormelon", "Durian"
      ].map(i => ({ name: i }))
    },
    {
      name: "Fall Crops Bundle",
      items: [
        "Garlic", "Yam", "Soda Pop Crop", "Fizzy Fruit", "Cranberry",
        "Barley", "Pumpkin", "Ghost Pepper", "Butternut"
      ].map(i => ({ name: i }))
    },
    {
      name: "Winter Crops Bundle",
      items: [
        "Tea Leaves", "Turnip", "Purple Eggplant", "Heat Fruit",
        "Marshmallow Bean", "Brr-Nana", "Star Fruit", "Hexagon Berry",
        "Snow Pea", "Snow Ball", "Balloon Fruit", "Blizzard Berry",
        "Pythagorean Berry", "Blue Moon Fruit", "Candy Cane"
      ].map(i => ({ name: i }))
    },
    {
      name: "Nel'Vari Crops Bundle",
      items: [
        "Acorn", "Rock Fruit", "Water Fruit", "Fire Fruit",
        "Walk Choy", "Wind Chime", "Shiiwalki Mushroom", "Dragon Fruit",
        "Mana Gem", "Cat Tail", "Indiglow"
      ].map(i => ({ name: i }))
    },
    {
      name: "Withergate Crops Bundle",
      items: [
        "Kraken Kale", "Tombmelon", "Suckerstem", "Razorstalk",
        "Snappy Plant", "Moonplant", "Eggplant", "Demon Orb"
      ].map(i => ({ name: i }))
    },
    {
      name: "Flowers Bundle",
      items: [
        "Red Rose", "Blue Rose", "Daisy", "Orchid", "Tulip",
        "Hibiscus", "Lavender", "Sunflower", "Lily", "Lotus", "Honey Flower"
      ].map(i => ({ name: i }))
    },
    {
      name: "Foraging Bundle",
      items: [
        "Apple", "Berry", "Blueberry", "Mushroom", "Orange",
        "Peach", "Raspberry", "Sand Dollar", "Seaweed", "Starfish",
        "Strawberry", "Log"
      ].map(i => ({ name: i }))
    },
    {
      name: "Exploration Bundle",
      items: [
        "Petrified Log", "Phoenix Feather", "Fairy Wings", "Griffon Egg",
        "Mana Sap", "Pumice Stone", "Mysterious Antler", "Dragon Fang",
        "Monster Candy", "Unicorn Hair Tuft"
      ].map(i => ({ name: i }))
    },
    {
      name: "Alchemy Bundle",
      items: [
        "Mana Potion", "Health Potion", "Attack Potion", "Speed Potion",
        "Defense Potion", "Advanced Attack Potion", "Advanced Defense Potion",
        "Advanced Spell Damage Potion", "Incredible Attack Potion",
        "Incredible Defense Potion", "Incredible Spell Damage Potion"
      ].map(i => ({ name: i }))
    },
    {
      name: "Combat Bundle",
      items: [
        "Leafie Trinket", "Elite Leafie Trinket", "Centipillar Trinket",
        "Peppinch - Green Trinket", "Scorpepper Trinket",
        "Elite Scorpepper Trinket", "Hat Crab Trinket", "Floaty Crab Trinket",
        "Bucket Crab Trinket", "Umbrella Crab Trinket", "Chimchuck Trinket",
        "Ancient Sun Haven Sword", "Ancient Nel'Varian Sword",
        "Ancient Withergate Sword"
      ].map(i => ({ name: i }))
    },
    {
      name: "Nel'Vari Temple Bundle",
      items: [
        "Origins of the Grand Tree and Nivara, Book I",
        "Origins of the Grand Tree and Nivara, Book II",
        "Origins of the Grand Tree and Nivara, Book III",
        "Origins of the Grand Tree and Nivara, Book IV",
        "Origins of the Grand Tree and Nivara, Book V",
        "Origins of Sun Haven and Elios, Book I",
        "Origins of Sun Haven and Elios, Book II",
        "Origins of Sun Haven and Elios, Book III",
        "Origins of Sun Haven and Elios, Book IV",
        "Origins of Sun Haven and Elios, Book V",
        "Origins of Dynus and Shadows, Book I",
        "Origins of Dynus and Shadows, Book II",
        "Origins of Dynus and Shadows, Book III",
        "Origins of Dynus and Shadows, Book IV",
        "Origins of Dynus and Shadows, Book V"
      ].map(i => ({ name: i }))
    }
  ]
},
  {
  hall: "Aquarium",
  bundles: [
    {
      name: "Fishing Bundle",
      items: [
        "Handmade Bobber", "Ancient Magic Staff", "Bronze Dragon Relic",
        "Old Sword Hilt", "Nel'Varian Runestone", "Ancient Elven Headdress",
        "Old Mayoral Painting", "Tentacle Monster Emblem",
        "Ancient Angel Quill", "Ancient Naga Crook", "Ancient Amari Totem"
      ].map(i => ({ name: i }))
    },
    {
      name: "Spring Fish Tank",
      items: [
        "Butterflyfish", "Sunfish", "Flower Flounder", "Raincloud Ray",
        "Floral Trout", "Neon Tetra", "Seahorse", "Painted Egg", "Tadpole"
      ].map(i => ({ name: i }))
    },
    {
      name: "Summer Fish Tank",
      items: [
        "Blazeel", "Hearth Angler", "Scorching Squid", "Magma Star",
        "Tinder Turtle", "Pyrelus", "Flame Ray", "Molten Slug", "Searback"
      ].map(i => ({ name: i }))
    },
    {
      name: "Fall Fish Tank",
      items: [
        "Coducopia", "King Salmon", "Hayfish", "Acorn Anchovy",
        "Vampire Piranha", "Ghostfish", "Pumpkin Jelly", "Pirate Perch",
        "Autumn Leaf Sole"
      ].map(i => ({ name: i }))
    },
    {
      name: "Winter Fish Tank",
      items: [
        "Frostfin", "Christmas Lightfish", "Holly Carp", "Jingle Bass",
        "Frozen Tuna", "Scarffish", "Heatfin", "Icicle Carp",
        "Blazing Herring"
      ].map(i => ({ name: i }))
    },
    {
      name: "Nel'vari Fish Tank",
      items: [
        "Robed Parrotfish", "Axolotl", "Frilled Betta", "Horsefish",
        "Flamefish", "Dragon Gulper", "Neapolitan Fish", "Snobfish",
        "Kelp Eel", "Princely Frog", "Angelfin", "Bubblefish",
        "Crystal Tetra", "Sky Ray"
      ].map(i => ({ name: i }))
    },
    {
      name: "Withergate Fish Tank",
      items: [
        "Kraken", "Water Bear", "Bonemouth Bass", "Mummy Trout",
        "Deadeye Shrimp", "Electric Eel", "Brain Jelly", "Redfinned Pincher",
        "Sea Bat", "Ghosthead Tuna", "Globfish", "Living Jelly", "Purrmaid",
        "Slime Leech", "Goblin Shark", "Moonfish", "Toothy Angler",
        "Vampire Squid", "Viperfish", "Albino Squid", "Devilfin",
        "Shadow Tuna"
      ].map(i => ({ name: i }))
    },
    {
      name: "Large Fish Tank",
      items: [
        "Pygmy Tuna", "Catfish", "Gold Fish", "Streamline Cod", "Salmon",
        "Clown Fish", "Black Bass", "Rainbow Trout", "Popeye Goldfish",
        "Pufferfish", "Ironhead Sturgeon", "Cuddlefish", "Lobster",
        "Silver Carp", "Tuna", "Blunted Swordfish", "Ribbon Eel",
        "Tiger Trout", "Eel", "Red Snapper", "Carp", "Redeye Piranha",
        "Angel Fish", "Whitebelly Shark", "Koi Fish", "Sandstone Fish"
      ].map(i => ({ name: i }))
    }
  ]
},
{
  hall: "Dynus Altar Room",
  bundles: [
    {
      name: "Rare Items Altar",
      items: [
        "Adventure Keepsake", "Riches Keepsake", "Romance Keepsake", "Peace Keepsake"
      ].map(i => ({ name: i }))
    },
    {
      name: "Fruit Altar",
      items: [
        { name: "Raspberry", amount: 20 },
        { name: "Peach", amount: 10 },
        { name: "Orange", amount: 20 },
        { name: "Blueberry", amount: 20 },
        { name: "Berry", amount: 10 },
        { name: "Apple", amount: 20 }
      ]
    },
    {
      name: "Foraging Altar",
      items: [
        { name: "Log", amount: 300 },
        { name: "Fire Crystal", amount: 30 },
        { name: "Earth Crystal", amount: 30 },
        { name: "Water Crystal", amount: 30 },
        { name: "Sand Dollar", amount: 10 }
      ]
    },
    {
      name: "Gold Altar",
      items: [
        { name: "Coins", amount: 100000 },
        { name: "Gold Bar", amount: 10 }
      ]
    },
    {
      name: "Cooking Altar",
      items: [
        "Cheesecake", "Spicy Ramen", "Sesame Rice Ball", "Pizza", "Cookie",
        "Coffee", "Tomato Soup", "Shimmeroot Treat", "Energy Smoothie"
      ].map(i => ({ name: i }))
    },
    {
      name: "Mining Altar",
      items: [
        { name: "Stone", amount: 999 },
        { name: "Coal", amount: 50 },
        { name: "Copper Ore", amount: 100 },
        { name: "Sapphire", amount: 10 },
        { name: "Ruby", amount: 10 },
        { name: "Amethyst", amount: 10 },
        { name: "Diamond", amount: 5 },
        { name: "Havenite", amount: 5 }
      ]
    },
    {
      name: "Farming Altar",
      items: [
        { name: "Wheat", amount: 30 },
        { name: "Corn", amount: 30 },
        { name: "Potato", amount: 30 },
        { name: "Tomato", amount: 30 },
        { name: "Carrot", amount: 30 },
        { name: "Sugar Cane", amount: 30 },
        { name: "Onion", amount: 30 },
        { name: "Greenroot", amount: 30 },
        { name: "Honey Flower", amount: 30 },
        { name: "Rice", amount: 30 }
      ]
    },
    {
      name: "Fishing Altar",
      items: [
        "Dorado", "Duorado", "Crab", "Sea Bass", "Gold Fish", "Bonemouth Bass",
        "Chromafin", "Golden Carp", "Flamefish", "Purrmaid",
        "Crystal Tetra", "Sky Ray"
      ].map(i => ({ name: i }))
    },
    {
      name: "Ticket Altar",
      items: [
        { name: "Tickets", amount: 5000 }
      ]
    }
  ]
}
];
    const trackerEl = document.getElementById("tracker");
    const hideCompletedToggle = document.getElementById("hideCompleted");
    const searchInput = document.getElementById("searchInput");
    const searchResults = document.getElementById("searchResults");
    const backToTopBtn = document.getElementById("backToTop");

    function saveProgress() {
      localStorage.setItem("sunhavenTracker", JSON.stringify(getProgress()));
    }

    function getProgress() {
      const checkboxes = document.querySelectorAll("input[type=checkbox][data-key]");
      const progress = {};
      checkboxes.forEach(cb => {
        progress[cb.dataset.key] = cb.checked;
      });
      return progress;
    }

    function loadProgress() {
      return JSON.parse(localStorage.getItem("sunhavenTracker") || "{}");
    }

    function render() {
      const saved = loadProgress();
      trackerEl.innerHTML = "";
      data.forEach((hallData, hallIndex) => {
        const hall = document.createElement("div");
        hall.className = "mb-4";
        const hallTitle = document.createElement("h2");
        hallTitle.textContent = hallData.hall;
        hall.appendChild(hallTitle);
        hallData.bundles.forEach((bundle, bundleIndex) => {
          const cardId = `bundle-${hallIndex}-${bundleIndex}`;
          const card = document.createElement("div");
          card.className = "card mb-3 bundle-card";
          card.id = cardId;
          const cardBody = document.createElement("div");
          cardBody.className = "card-body";
          const headerRow = document.createElement("div");
          headerRow.className = "d-flex justify-content-between align-items-center mb-2";
          const title = document.createElement("h5");
          title.className = "card-title mb-0";
          title.textContent = bundle.name;
          let completeCount = 0;
          const total = bundle.items.length;
          bundle.items.forEach((item, itemIndex) => {
            const key = `${hallIndex}-${bundleIndex}-${itemIndex}`;
            if (saved[key]) completeCount++;
          });
          const percent = Math.round((completeCount / total) * 100);
          const progressWrapper = document.createElement("div");
          progressWrapper.className = "d-flex align-items-center";
          const circle = document.createElement("div");
          circle.className = "progress-circle";
          circle.style.background = `conic-gradient(#198754 ${percent}%, #ddd ${percent}%)`;
          const inner = document.createElement("div");
          inner.className = "progress-circle-inner";
          inner.textContent = `${percent}%`;
          circle.appendChild(inner);
          const progressText = document.createElement("span");
          progressText.className = "ms-2 small text-muted";
          progressText.textContent = `${completeCount} / ${total} items`;
          progressWrapper.appendChild(circle);
          progressWrapper.appendChild(progressText);
          headerRow.appendChild(title);
          headerRow.appendChild(progressWrapper);
          cardBody.appendChild(headerRow);
          const list = document.createElement("ul");
          list.className = "list-group list-group-flush mb-2";
          bundle.items.forEach((item, itemIndex) => {
            const key = `${hallIndex}-${bundleIndex}-${itemIndex}`;
            const li = document.createElement("li");
            li.className = "list-group-item";
            const cb = document.createElement("input");
            cb.type = "checkbox";
            cb.className = "form-check-input me-2";
            cb.dataset.key = key;
            cb.checked = !!saved[key];
            const label = document.createElement("label");
            label.textContent = item.name;
            if (item.amount) label.textContent += ` (${item.amount.toLocaleString()})`;
            if (cb.checked) label.classList.add("checked-label");
            cb.addEventListener("change", () => { saveProgress(); render(); });
            li.appendChild(cb);
            li.appendChild(label);
            list.appendChild(li);
          });
          if (completeCount === total && hideCompletedToggle.checked) card.classList.add("completed");
          else card.classList.remove("completed");
          cardBody.appendChild(list);
          card.appendChild(cardBody);
          hall.appendChild(card);
        });
        trackerEl.appendChild(hall);
      });
    }

    function handleSearch() {
      const query = searchInput.value.trim().toLowerCase();
      searchResults.innerHTML = "";
      if (!query) return;
      const matches = [];
      data.forEach((hall, hallIndex) => {
        hall.bundles.forEach((bundle, bundleIndex) => {
          bundle.items.forEach((item, itemIndex) => {
            const itemName = item.name.toLowerCase();
            if (itemName.includes(query)) {
              const displayName = item.amount ? `${item.name} (${item.amount.toLocaleString()})` : item.name;
              const id = `bundle-${hallIndex}-${bundleIndex}`;
              matches.push(`<li class="list-group-item">
                <a href="#${id}" class="text-decoration-none">
                  <strong>${displayName}</strong> â€” ${bundle.name} (${hall.hall})
                </a>
              </li>`);
            }
          });
        });
      });
      if (matches.length) searchResults.innerHTML = `<ul class="list-group">${matches.join("")}</ul>`;
      else searchResults.textContent = "No matches found.";
    }

    function toggleBackToTop() {
      backToTopBtn.style.display = window.scrollY > 200 ? 'block' : 'none';
    }

    function exportProgress() {
      const data = JSON.stringify(getProgress(), null, 2);
      const blob = new Blob([data], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "sunhaven-progress.json";
      a.click();
      URL.revokeObjectURL(url);
    }

    function importProgress(file) {
      const reader = new FileReader();
      reader.onload = (event) => {
        try {
          const imported = JSON.parse(event.target.result);
          if (typeof imported === "object") {
            localStorage.setItem("sunhavenTracker", JSON.stringify(imported));
            alert("Progress imported successfully!");
            render();
          } else {
            alert("Invalid file format.");
          }
        } catch (e) {
          alert("Failed to import file.");
        }
      };
      reader.readAsText(file);
    }

    hideCompletedToggle.addEventListener("change", render);
    searchInput.addEventListener("input", handleSearch);
    document.getElementById("exportBtn").addEventListener("click", exportProgress);
    document.getElementById("importFile").addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (file) importProgress(file);
    });
    window.addEventListener("scroll", toggleBackToTop);
    backToTopBtn.addEventListener("click", () => window.scrollTo({ top: 0, behavior: 'smooth' }));

    render();
  </script>
</body>
</html>
